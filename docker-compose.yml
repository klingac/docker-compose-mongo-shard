version: '2.1'

services:
  #config servers
  mongodb-conf-rs-1:
    image: mongo:4.0
    volumes:
      - ./mongo-config:/etc/mongo
      - ./mongo-data:/data/db
      - ./mongo-logs:/var/log/mongodb
      - ./mongo-initdb:/docker-entrypoint-initdb.d
      - ./mongo-dump:/data/dump
    mem_limit: 18g
    memswap_limit: 0
    mem_swappiness: 0
    networks:
      - default
    command: ["mongod", "--config", "/etc/mongo/mongod.conf", "--setParameter", "honorSystemUmask=true"]


  mongodb:
    image: mongo:4.0
    volumes:
      - ./mongo-config:/etc/mongo
      - ./mongo-data:/data/db
      - ./mongo-logs:/var/log/mongodb
      - ./mongo-initdb:/docker-entrypoint-initdb.d
      - ./mongo-dump:/data/dump
    mem_limit: 18g
    memswap_limit: 0
    mem_swappiness: 0
    networks:
      - default
    command: ["mongod", "--config", "/etc/mongo/mongod.conf", "--setParameter", "honorSystemUmask=true"]

networks:
  default:
    driver: bridge
    ipam:
      config:
        - subnet: 192.168.124.0/28
  # proxy-tier:
  #   external:
  #     name: proxy_default
